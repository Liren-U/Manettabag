---
/**
 * ManettaBag-FAQ.astro
 * ğŸš€ æè‡´æ€§èƒ½ä¼˜åŒ–ç‰ˆ (Below the Fold Optimization)
 * 1. [Rendering] content-visibility: auto (å±å¹•å¤–å®Œå…¨ä¸æ¸²æŸ“ï¼Œé™ä½ TBT)
 * 2. [JS] IntersectionObserver (æ»šåŠ¨åˆ°é™„è¿‘æ‰æ‰§è¡Œ JSï¼Œä¸å ç”¨é¦–å±èµ„æº)
 * 3. [Layout] ä¿æŒé«˜æ€§èƒ½æ‰‹é£ç´åŠ¨ç”»
 */
---

<section
  id="faq"
  class="py-32 bg-dark-main border-t border-white/5 contain-layout"
  style="content-visibility: auto; contain-intrinsic-size: 600px;"
>
  <div class="max-w-[800px] mx-auto px-6">
    <h2 class="font-display font-bold text-4xl mb-16 text-center text-white">
      Common Questions
    </h2>

    <div class="space-y-4">
      <details
        class="group bg-dark-sec rounded-2xl border border-white/5 overflow-hidden transition-all duration-300 hover:border-brand/30"
      >
        <summary
          class="flex justify-between items-center p-6 cursor-pointer list-none font-bold text-xl select-none text-white outline-none"
        >
          Is it fully waterproof?
          <span
            class="transition-transform duration-300 group-open:rotate-180 text-brand shrink-0 ml-4"
          >
            <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
          </span>
        </summary>

        <div class="faq-content px-6 pb-0 border-t border-white/5">
          <div class="pt-6 pb-8 text-light-muted text-lg leading-relaxed">
            We use 600D water-resistant fabric + waterproof zippers. It handles rain and snow perfectly.
          </div>
        </div>
      </details>

      <details
        class="group bg-dark-sec rounded-2xl border border-white/5 overflow-hidden transition-all duration-300 hover:border-brand/30"
      >
        <summary
          class="flex justify-between items-center p-6 cursor-pointer list-none font-bold text-xl select-none text-white outline-none"
        >
          Fits a 16&quot; MacBook Pro?
          <span
            class="transition-transform duration-300 group-open:rotate-180 text-brand shrink-0 ml-4"
          >
            <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
          </span>
        </summary>

        <div class="faq-content px-6 pb-0 border-t border-white/5">
          <div class="pt-6 pb-8 text-light-muted text-lg leading-relaxed">
            Yes. The suspended laptop sleeve is designed specifically to protect up to 16&quot; laptops from bottom impact.
          </div>
        </div>
      </details>
    </div>
  </div>
</section>

<style>
  /* éšè—åŸç”Ÿçš„å°ä¸‰è§’ */
  #faq summary::-webkit-details-marker {
    display: none;
  }

  /* åŠ¨ç”» CSSï¼šGPU åŠ é€Ÿ */
  #faq details .faq-content {
    overflow: hidden;
    height: 0;
    opacity: 0;
    transition:
      height 250ms cubic-bezier(0.4, 0, 0.2, 1),
      opacity 200ms ease-out;
    will-change: height, opacity;
  }

  #faq details[open] .faq-content {
    opacity: 1;
  }
</style>

<script is:inline>
  // å°†åˆå§‹åŒ–é€»è¾‘å°è£…
  function initFAQ() {
    const detailsList = document.querySelectorAll("#faq details");

    detailsList.forEach((details) => {
      const summary = details.querySelector("summary");
      const content = details.querySelector(".faq-content");
      if (!summary || !content) return;

      let isAnimating = false;

      const openDetails = () => {
        if (isAnimating) return;
        isAnimating = true;
        details.setAttribute("open", "true");
        content.style.height = "0px";
        content.style.opacity = "0";

        const targetHeight = content.scrollHeight;

        requestAnimationFrame(() => {
          content.style.height = targetHeight + "px";
          content.style.opacity = "1";
        });

        const onEnd = (event) => {
          if (event.propertyName !== "height") return;
          content.style.height = "auto";
          content.removeEventListener("transitionend", onEnd);
          isAnimating = false;
        };
        content.addEventListener("transitionend", onEnd);
      };

      const closeDetails = () => {
        if (isAnimating) return;
        isAnimating = true;
        const startHeight = content.scrollHeight;
        content.style.height = startHeight + "px";
        content.style.opacity = "1";

        requestAnimationFrame(() => {
          content.style.height = "0px";
          content.style.opacity = "0";
        });

        const onEnd = (event) => {
          if (event.propertyName !== "height") return;
          details.removeAttribute("open");
          content.removeEventListener("transitionend", onEnd);
          isAnimating = false;
        };
        content.addEventListener("transitionend", onEnd);
      };

      summary.addEventListener("click", (event) => {
        event.preventDefault();
        const isOpen = details.hasAttribute("open");
        if (isOpen) {
          closeDetails();
        } else {
          openDetails();
        }
      });
    });
  }

  // ğŸš€ ä½¿ç”¨ IntersectionObserver å®ç°æ‡’åˆå§‹åŒ–
  // åªæœ‰å½“ #faq è¿›å…¥è§†å£ï¼ˆrootMargin ç¨å¾®æå‰ä¸€ç‚¹ï¼‰æ—¶ï¼Œæ‰è¿è¡Œ JS
  const faqSection = document.getElementById('faq');
  if (faqSection) {
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          initFAQ();
          observer.disconnect(); // åˆå§‹åŒ–ä¸€æ¬¡åå°±æ–­å¼€ï¼ŒèŠ‚çœèµ„æº
        }
      });
    }, { rootMargin: "200px" }); // æå‰ 200px åˆå§‹åŒ–ï¼Œç”¨æˆ·æ— æ„ŸçŸ¥
    
    observer.observe(faqSection);
  }
</script>