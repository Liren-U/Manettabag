---
/*
  ManettaBag-Header.astro
  性能优化版：
  1. JS: 使用 requestAnimationFrame 优化滚动监听，防止掉帧。
  2. JS: 启用 { passive: true } 提升移动端滚动性能。
  3. CSS: 将 transition-all 改为具体属性，减少浏览器重绘负担。
*/
---

<header
  id="navbar"
  class="fixed top-0 left-0 w-full z-50 border-b border-white/5 transition-[background-color,border-color,box-shadow,backdrop-filter] duration-500 ease-in-out will-change-[background-color,backdrop-filter]"
>
  <div class="max-w-limit mx-auto px-6 lg:px-gutter h-[88px] flex justify-between items-center transform-gpu">

    <a href="https://manettabag.com" class="group" aria-label="Manetta Home">
      <div
        id="nav-logo"
        class="text-2xl font-display font-bold tracking-tighter text-white transition-colors duration-300 group-hover:text-brand"
      >
        MANETTA<span class="text-brand">.</span>
      </div>
    </a>

    <div class="flex items-center gap-6">
      <a
        href="#reserve"
        class="relative overflow-hidden bg-brand text-white px-8 py-3 rounded-full text-sm font-bold shadow-glow hover:shadow-brand/60 transition-all duration-300 hover:-translate-y-0.5 group"
      >
        <span class="relative z-10 flex items-center gap-2">
          Reserve Now
          <svg
            class="w-4 h-4 transition-transform group-hover:translate-x-1"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M14 5l7 7m0 0l-7 7m7-7H3"
            />
          </svg>
        </span>

        <div
          class="absolute inset-0 bg-gradient-to-r from-white/0 via-white/30 to-white/0 transform -translate-x-full group-hover:translate-x-full transition-transform duration-700 ease-in-out"
        ></div>
      </a>
    </div>
  </div>
</header>

<script is:inline>
  const navbar = document.getElementById("navbar");
  let ticking = false; // 节流锁

  if (navbar) {
    // 定义滚动处理逻辑
    const onScroll = () => {
      if (window.scrollY > 50) {
        navbar.classList.add("nav-scrolled");
        navbar.classList.remove("border-white/5");
      } else {
        navbar.classList.remove("nav-scrolled");
        navbar.classList.add("border-white/5");
      }
      ticking = false; // 解锁
    };

    window.addEventListener("scroll", () => {
      if (!ticking) {
        // 请求下一帧执行，而不是立即执行
        window.requestAnimationFrame(onScroll);
        ticking = true; // 上锁
      }
    }, { passive: true }); // ⭐ 关键：告诉浏览器不阻止默认滚动，提升移动端流畅度
  }
</script>